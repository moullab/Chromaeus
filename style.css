/* ======= Compact Neon-Teal Theme (single skin) ======= */
:root{
  --radius:10px; --shadow:0 1px 8px rgba(0,0,0,.06);
  --bg:#eef0f3; --panel:#f6f8fb; --card:#ffffff; --ink:#1f232b; --muted:#69707f; --grid:#e7eaf1; --table-head:#f1f4f9; --chip:#eef8f6; --canvas-frame:#ffffff; --chart-ink:#1f232b;
  --accent:#23d9b4; --accent-weak:rgba(35,217,180,.15);
  --ok:#2fbf7a; --warn:#e6b65a; --danger:#ef6a7a;
  --ring:0 0 0 2px rgba(35,217,180,.5);
  --pad-xs:6px; --pad-sm:8px; --pad-md:10px;
}
[data-theme="dark"]{
  --bg:#121418; --panel:#181b20; --card:#1e2228; --ink:#eaeef8; --muted:#9aa0ad; --grid:#2a2f37; --table-head:#20252d; --chip:#1b2624; --canvas-frame:#15181d; --chart-ink:#eef2fb;
  --shadow:0 1px 8px rgba(0,0,0,.5);
}
*{box-sizing:border-box;font-family:Inter,Segoe UI,Roboto,Arial,sans-serif}
html,body{height:100%} body{margin:0;background:var(--bg);color:var(--ink)}
button,input,select{font:inherit;color:var(--ink)}
.app{display:grid;grid-template-rows:auto auto 1fr; height:100vh; min-height:0}

/* ======= Topbar ======= */
.topbar{
  display:grid; grid-template-columns:1fr auto auto; gap:8px; align-items:center;
  padding:8px 12px; background:var(--panel); box-shadow:var(--shadow); position:sticky; top:0; z-index:50
}
.brand{display:flex;align-items:center;gap:8px}
.badge{width:28px;height:28px;border-radius:999px;background:linear-gradient(135deg,#60e7cf,#23d9b4)}
.brandTitle{font-weight:800;letter-spacing:.2px;font-size:16px}
.brandTag{font-size:11px;color:var(--muted)}
.row{display:flex;align-items:center;gap:8px}
.mini{font-size:11px;color:var(--muted)}

/* Light/Dark slide */
.switch{position:relative; width:52px; height:26px; background:var(--grid); border-radius:999px; cursor:pointer; border:1px solid rgba(0,0,0,.1)}
.switch::after{content:""; position:absolute; top:2px; left:2px; width:22px; height:22px; background:var(--card); border-radius:50%; box-shadow:var(--shadow); transition:transform .18s ease}
.switch.on{background:var(--accent-weak)}
.switch.on::after{transform:translateX(26px)}
.switchLabel{margin-left:4px; font-size:12px; color:var(--muted)}

/* ======= Controls (compact) ======= */
.btn{padding:6px 8px;border-radius:8px;border:1px solid rgba(0,0,0,.12);background:var(--card);color:var(--ink);cursor:pointer;line-height:1}
.btn:hover{box-shadow:var(--shadow)}
.btn.primary{background:var(--accent);border-color:var(--accent);color:#0b1110}
.btn.danger{background:var(--danger);border-color:var(--danger);color:#fff}
.btn.tiny{padding:4px 6px;font-size:12px}
.chipbtn{padding:6px 8px;border-radius:8px;border:1px solid rgba(0,0,0,.12);background:var(--card);cursor:pointer;font-size:12px;line-height:1}
.chipbtn.active{outline:var(--ring); background:var(--accent-weak)}
.togglebtn{padding:6px 8px;border-radius:8px;border:1px solid rgba(0,0,0,.12);background:var(--card);cursor:pointer;font-size:12px;line-height:1}
.togglebtn.on{background:var(--accent); color:#0b1110; border-color:var(--accent)}
.pill{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:8px;background:var(--chip);border:1px solid rgba(0,0,0,.06);color:var(--ink);font-size:12px}

input[type="range"]{height:6px}

/* ======= Slim Ribbon (single row) ======= */
.ribbon{
  display:flex; gap:8px; align-items:stretch; padding:8px 12px; background:var(--panel); box-shadow:var(--shadow); position:sticky; top:44px; z-index:19; overflow:auto;
}
.card{background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:8px; display:flex; flex-direction:column; gap:6px; min-width:180px; border:1px solid rgba(0,0,0,.06)}
.card h4{margin:0; font-size:12px; font-weight:800; color:var(--muted); letter-spacing:.2px}
.grid{display:grid; gap:6px}
.grid2{display:grid; grid-template-columns:repeat(2,1fr); gap:6px}
.grid3{display:grid; grid-template-columns:repeat(3,1fr); gap:6px}

/* Checkbox Styling */
.checkLabel {
    display: flex;
    align-items: center;
    gap: 12px; 
    cursor: pointer;
    font-size: 12px;
    font-weight: normal;
    color: var(--text);
    user-select: none;
    margin-left: 8px; 
}

.checkLabel input[type="checkbox"] {
    width: 16px;
    height: 16px;
    cursor: pointer;
    accent-color: var(--accent); 
}
/* tighter cards */
.card.general{min-width:300px}
.card.selection{min-width:250px}
.stackV > * + *{margin-top:6px}
.card.colors{min-width:160px}
.card.columns{min-width:520px}

/* General card: single-line button row with vertical dividers */
.generalRow{
  display:flex;
  align-items:center;
  gap:0;
  margin-top:4px;
  flex-wrap:nowrap;
  overflow-x:auto;
}
.btnGroup{
  display:flex;
  align-items:center;
  gap:6px;
  padding:0 6px;
}
.btnGroup + .btnGroup{
  border-left:1px solid var(--grid);
  margin-left:4px;
}

/* ======= Main (no helper tile) ======= */
.main{display:grid; grid-template-columns:1fr; padding:10px; gap:10px; min-height:0}

/* Canvas wrapper with scrollbars for image only */
.canvasWrap{position:relative; background:var(--canvas-frame); border-radius:12px; box-shadow:var(--shadow); overflow:auto; min-height:320px}
.innerCanvas{position:relative; width:fit-content; height:fit-content}
canvas{display:block; background:#fafafa}

/* Styled scrollbars */
.canvasWrap::-webkit-scrollbar, .floatTableBody::-webkit-scrollbar{
  height:10px; width:10px;
}
.canvasWrap::-webkit-scrollbar-thumb, .floatTableBody::-webkit-scrollbar-thumb{
  background:var(--grid); border-radius:999px; border:2px solid transparent; background-clip:padding-box;
}
.canvasWrap::-webkit-scrollbar-track, .floatTableBody::-webkit-scrollbar-track{
  background:transparent;
}

/* ======= Floating results table (FIXED, independent) ======= */
.floatTable{
  position:fixed;
  top:118px; right:16px;
  background:var(--card); border:1px solid rgba(0,0,0,.12); border-radius:10px; box-shadow:var(--shadow);
  width:520px;
  max-height:80vh;
  display:flex; flex-direction:column; z-index:30;
}
.floatTableHead{
  padding:6px 8px;
  background:var(--accent-weak);
  border-bottom:1px solid var(--grid);
  font-size:12px;
  font-weight:700;
  cursor:move;
  user-select:none;
}
.floatTableBody{
  overflow:auto;
  max-height:calc(80vh - 32px);
}
table{border-collapse:collapse; font-size:12px; width:100%; color:var(--ink)}
th,td{border-bottom:1px solid var(--grid); padding:6px 8px; white-space:nowrap; text-align:right}
thead th{position:sticky; top:0; background:var(--table-head); z-index:1; text-align:center}
.swatch{width:14px;height:14px;border-radius:4px;border:1px solid rgba(0,0,0,.15); display:inline-block}

/* ROI strip */
.roiBar{display:flex; gap:8px; padding:8px; background:var(--panel); border-radius:var(--radius); box-shadow:var(--shadow); overflow-x:auto}
.thumb{
  min-width:120px;
  height:64px;
  border-radius:10px;
  background:var(--card);
  box-shadow:var(--shadow);
  display:flex;
  align-items:stretch;
  justify-content:stretch;
  position:relative;
  overflow:hidden;
  border:1px solid rgba(0,0,0,.12);
}

/* ======= Drawer unified with main UI ======= */
.drawer {
  position: fixed;
  top: 50px;
  right: 0;
  height: calc(100vh - 50px);
  width: 520px;
  background: var(--card);
  border-left: 1px solid var(--grid);
  box-shadow: -4px 0 16px rgba(0,0,0,.18);
    transform: translateX(100%);
  transition: transform .22s ease;
    z-index: 40; 
  display: flex;
  flex-direction: column;
}

/* Open State */
.drawer.open {
  transform: translateX(0);
}

.drawerHead{
  padding:10px;
  border-bottom:1px solid var(--grid);
  display:flex;
  align-items:center;
  gap:8px;
  justify-content:space-between;
}

.drawerBody{
  padding:10px;
  overflow:auto;
  display:flex;
  flex-direction:column;
  gap:8px;
}

.drawerSection{
  border:1px solid var(--grid);
  border-radius:10px;
  padding:8px;
  background:var(--panel);
}

.drawerSection h4{
  margin:0 0 6px;
  font-size:12px;
  color:var(--muted);
}

/* Table in drawer â€“ tighter columns, fully inside drawer */
.tableLike{
  width:100%;
  font-size:12px;
  border-collapse:separate;
  border-spacing:0 6px;
  table-layout:fixed;
}

.tableLike th{
  font-weight:700;
  color:var(--muted);
  text-align:left;
  padding:0 6px 6px 6px;
  position:sticky;
  top:0;
  background:var(--panel);
  z-index:1;
}

.tableLike th:nth-child(3),
.tableLike td:nth-child(3){
  width:80px;
}

.tableLike th:nth-child(4),
.tableLike td:nth-child(4){
  width:80px;
}

.tableLike td{
  background:var(--card);
  padding:6px;
  border:1px solid var(--grid);
  color:var(--ink);
}

.tableLike tr td:first-child{border-radius:8px 0 0 8px}
.tableLike tr td:last-child{border-radius:0 8px 8px 0}

/* Chart box styled like other cards */
.chart{
  width:100%;
  height:240px;
  border:1px solid var(--grid);
  border-radius:8px;
  background:var(--panel);
  position:relative;
}
.chart canvas{width:100%;height:100%}

/* Equation / info box */
.eqbox{
  margin-top:6px;
  padding:6px;
  border-radius:8px;
  background:var(--card);
  border:1px solid var(--grid);
  font-size:12px;
  color:var(--ink);
}

/* Drawer inputs & selects */
.drawer input[type="text"],
.drawer input[type="number"],
.drawer select{
  width:100%;
  padding:6px 8px;
  border-radius:6px;
  border:1px solid var(--grid);
  background:var(--card);
  color:var(--ink);
  outline:none;
  font-size:12px;
}

.drawer input[type="text"]:focus,
.drawer input[type="number"]:focus,
.drawer select:focus{
  border-color:var(--accent);
  box-shadow:var(--ring);
}

.dragHandle{
  position:absolute;
  left:-8px;
  top:0;
  width:8px;
  height:100%;
  cursor:ew-resize;
  background:transparent;
}
/* ======= Custom File Input Button ======= */
input[type="file"] {
  font-size: 12px;
  color: var(--muted); /* The text 'No file chosen' will be grey */
}

/* This targets the specific button inside the input */
input[type="file"]::file-selector-button {
  background-color: var(--accent); /* Teal color */
  color: #0b1110; /* Dark text for contrast */
  border: 1px solid var(--accent);
  border-radius: 8px; /* Rounded corners matching your theme */
  padding: 6px 12px;
  margin-right: 10px;
  cursor: pointer;
  font-family: inherit;
  font-weight: 600;
  transition: box-shadow 0.2s ease;
}

/* Hover effect */
input[type="file"]::file-selector-button:hover {
  box-shadow: var(--shadow);
  opacity: 0.9;
}

.dot{display:inline-block; width:8px; height:8px; border-radius:999px; margin-right:6px}
.dot.green{background:#41d36a}
.dot.blue{background:var(--accent)}

/* ======= Stats Table in Drawer ======= */
.statsTable {
  width: 100%;
  border-collapse: collapse;
  font-size: 11px; /* Slightly smaller to fit */
  margin-top: 4px;
  color: var(--ink);
}

.statsTable th {
  background: var(--accent-weak); /* Teal header */
  padding: 6px;
  text-align: left;
  border: 1px solid var(--grid);
  font-weight: 700;
}

.statsTable td {
  padding: 4px 6px;
  border: 1px solid var(--grid);
}

/* Zebra striping: makes every other row slightly grey */
.statsTable tr:nth-child(even) {
  background: var(--chip);
}
/* Magic Wand Input */
#wandTol {
  border: 1px solid var(--grid);
  border-radius: 6px;
  font-size: 12px;
  background: var(--card);
  color: var(--ink);
  outline: none;
}
#wandTol:focus {
  border-color: var(--accent);
  box-shadow: var(--ring);
}
/* Custom style for "beta" in drawer title */
.beta-tag {
  font-size: 0.8em; /* 80% of the parent font size */
  font-style: italic; /* Keep it italic */
  font-weight: normal; /* Override parent's bold */
  color: var(--muted); /* Use the muted grey color */
  margin-left: 4px; /* A little space from "Calculation" */
}
/* ======= Help & Modal Styles ======= */
:root {
  --salmon: #ff9aa2; /* Light Salmon color */
  --salmon-dark: #ff808b;
}

/* 1. The Salmon Button */
.btn.salmon {
  background: var(--salmon);
  border-color: var(--salmon-dark);
  color: #4a0d13;
  font-weight: 600;
  /* Add these two lines to match the File Input button */
  padding: 6px 12px; 
  height: 29px; /* Force the height to match */
}
.btn.salmon:hover {
  background: var(--salmon-dark);
  box-shadow: var(--shadow);
}

/* 2. The Dropdown Menu */
.help-wrapper {
  position: relative; /* Anchor for the dropdown */
}
.help-dropdown {
  display: none; /* Hidden by default */
  position: absolute;
  top: 110%; /* Just below the button */
  right: 0;
  width: 180px;
  background: var(--card);
  border: 1px solid var(--grid);
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  padding: 8px 0;
  z-index: 100;
  flex-direction: column;
}
.help-dropdown.show {
  display: flex;
}
.help-section {
  padding: 8px 12px;
  border-bottom: 1px solid var(--grid);
}
.help-section:last-child { border-bottom: none; }
.help-section h5 {
  margin: 0 0 4px;
  font-size: 11px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.help-link {
  display: block;
  font-size: 13px;
  color: var(--ink);
  text-decoration: none;
  cursor: pointer;
  padding: 2px 0;
}
.help-link:hover { color: var(--accent); text-decoration: underline; }

/* 3. The Modal (Overlay) */
.modal-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  z-index: 999;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(2px);
}
.modal-overlay.open { display: flex; }

.modal-box {
  background: var(--card);
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.3);
  width: 900px;
  max-width: 95vw;
  min-height: 400px;
  max-height: 90vh;
  overflow: auto;
  position: relative;
  display: flex;
  flex-direction: column;
}
.modal-close {
  position: absolute;
  top: 10px; right: 10px;
  background: transparent;
  border: none;
  font-size: 20px;
  cursor: pointer;
  color: var(--muted);
}
.modal-content {
  margin-top: 10px;
  text-align: center;
}
/* Style for the Citation Text */
.cite-box {
  background: var(--panel);
  padding: 15px;
  border-radius: 8px;
  border: 1px solid var(--grid);
  font-family: monospace;
  margin-top: 10px;
}
